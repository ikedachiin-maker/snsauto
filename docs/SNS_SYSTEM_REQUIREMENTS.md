# 全SNS分析リサーチ＋記事作成システム 要件定義書

> 文書ID: REQ-SNS-2026-001
> 作成日: 2026-02-04
> ステータス: Draft v1.0
> 前提文書: `docs/SNS_ANALYSIS_SYSTEM_PROPOSAL.md`

---

## 目次

1. [プロジェクト概要](#1-プロジェクト概要)
2. [ステークホルダーと利用者](#2-ステークホルダーと利用者)
3. [スコープ定義](#3-スコープ定義)
4. [システム構成（5層アーキテクチャ）](#4-システム構成5層アーキテクチャ)
5. [機能要件 — Layer 1: データ収集層](#5-機能要件--layer-1-データ収集層)
6. [機能要件 — Layer 2: 分析層](#6-機能要件--layer-2-分析層)
7. [機能要件 — Layer 3: コンテンツ生成層](#7-機能要件--layer-3-コンテンツ生成層)
8. [機能要件 — Layer 4: 配信層](#8-機能要件--layer-4-配信層)
9. [機能要件 — Layer 5: 自動化オーケストレーション層](#9-機能要件--layer-5-自動化オーケストレーション層)
10. [非機能要件](#10-非機能要件)
11. [外部インターフェース要件](#11-外部インターフェース要件)
12. [データ要件](#12-データ要件)
13. [セキュリティ要件](#13-セキュリティ要件)
14. [制約事項と前提条件](#14-制約事項と前提条件)
15. [受入基準](#15-受入基準)
16. [実装フェーズ定義](#16-実装フェーズ定義)
17. [用語集](#17-用語集)

---

## 1. プロジェクト概要

### 1.1 目的

全主要SNSプラットフォーム（10種）のデータを自動収集・分析し、その分析結果を基にSEO最適化された記事およびマルチフォーマットのコンテンツを自動生成・配信するシステムを構築する。

### 1.2 ビジネスゴール

| ID | ゴール | 成功指標 |
|----|--------|----------|
| BG-01 | SNS横断の市場・トレンド分析を自動化 | 10プラットフォームからのデータ自動取得 |
| BG-02 | 分析データに基づく高品質記事の自動生成 | 月間記事生成数30本以上 |
| BG-03 | マルチチャネル配信の自動化 | 記事→SNS投稿×N+ショート動画の自動変換 |
| BG-04 | SEO/GEOパフォーマンスの最大化 | SEOスコア80点以上の記事生成率90% |
| BG-05 | 運用コストの最適化 | 月額$200以内での本格運用 |

### 1.3 システム名称

**TAISUN SNS Intelligence System（TSIS）**

### 1.4 技術基盤

- **ランタイム**: taisun_agent v2.6.0（既存システム）
- **プロトコル**: MCP（Model Context Protocol）
- **AI基盤**: Claude Code + Claude Code Skills
- **データ収集**: Apify Actor + MCP統合
- **自動化**: n8n MCP + Apify Scheduler

---

## 2. ステークホルダーと利用者

### 2.1 利用者分類

| ID | 利用者 | 役割 | 利用頻度 |
|----|--------|------|----------|
| U-01 | マーケティング担当 | SNS分析結果の確認、記事テーマの承認 | 日次 |
| U-02 | コンテンツ制作者 | 生成された記事の最終レビュー・編集 | 日次 |
| U-03 | システム管理者 | MCP設定、API管理、ワークフロー管理 | 週次 |
| U-04 | 経営判断者 | 分析レポートの閲覧、戦略判断 | 月次 |

### 2.2 外部システム

| ID | システム | 接続方式 | 用途 |
|----|----------|----------|------|
| EX-01 | Apify Platform | MCP / REST API | データ収集 |
| EX-02 | SociaVault | MCP | SNS統合分析 |
| EX-03 | DataForSEO | MCP | SEO分析 |
| EX-04 | Google Search Console | MCP | 自社SEOデータ |
| EX-05 | Ghost CMS / WordPress | MCP | 記事公開 |
| EX-06 | n8n | MCP | ワークフロー自動化 |
| EX-07 | 各SNS API | MCP / REST API | 投稿配信 |

---

## 3. スコープ定義

### 3.1 対象プラットフォーム（10種）

| 優先度 | プラットフォーム | データ取得 | 分析 | 投稿配信 |
|--------|------------------|-----------|------|----------|
| P1（必須） | Twitter / X | ○ | ○ | ○ |
| P1（必須） | Instagram | ○ | ○ | ○ |
| P1（必須） | YouTube | ○ | ○ | △（動画リンク共有） |
| P1（必須） | TikTok | ○ | ○ | △（動画生成のみ） |
| P2（重要） | Facebook | ○ | ○ | ○ |
| P2（重要） | LinkedIn | ○ | ○ | ○ |
| P2（重要） | Reddit | ○ | ○ | △（投稿のみ） |
| P3（拡張） | Pinterest | ○ | ○ | × |
| P3（拡張） | Threads | ○ | ○ | × |
| P3（拡張） | Bluesky | ○ | ○ | × |

### 3.2 スコープ内

- 全10 SNSプラットフォームからのデータ自動収集
- 収集データの構造化・正規化・保存
- センチメント分析・トレンド検出・競合分析
- SEO/GEO最適化されたブログ記事の自動生成
- SNS投稿コンテンツの自動生成（テキスト+画像提案）
- ショート動画台本の自動生成
- CMS（Ghost/WordPress）への自動公開
- SNSへの自動投稿
- 分析レポートの自動生成

### 3.3 スコープ外

- 動画撮影・編集の実行（台本・スクリプト生成まで）
- 広告出稿の直接管理（分析のみ）
- DM・メッセージの自動返信
- リアルタイムライブ配信
- 課金・決済機能

---

## 4. システム構成（5層アーキテクチャ）

```
Layer 5: 自動化オーケストレーション層
   ↑ スケジュール実行・監視・アラート
Layer 4: 配信層
   ↑ CMS公開・SNS投稿・動画配信
Layer 3: コンテンツ生成層
   ↑ 企画・執筆・SEO最適化・リパーパス
Layer 2: 分析層
   ↑ SNS分析・センチメント・トレンド・SEO・競合
Layer 1: データ収集層
   ↑ 10 SNS対応スクレイピング・API連携
```

---

## 5. 機能要件 — Layer 1: データ収集層

### FR-1.1 マルチプラットフォーム データ収集

> **要件**: システムは、10種のSNSプラットフォームから以下のデータタイプを自動収集できること。

| ID | データタイプ | 対象SNS | 取得方式 | 優先度 |
|----|-------------|---------|----------|--------|
| FR-1.1.1 | 投稿テキスト・メディア | 全プラットフォーム | Apify MCP | P1 |
| FR-1.1.2 | エンゲージメント指標（いいね/シェア/コメント/リポスト） | 全プラットフォーム | Apify MCP | P1 |
| FR-1.1.3 | ユーザープロフィール（フォロワー数/Bio/URL） | 全プラットフォーム | Apify MCP | P1 |
| FR-1.1.4 | ハッシュタグ関連データ | Instagram/TikTok/X/YouTube | Apify MCP | P1 |
| FR-1.1.5 | コメント・リプライ | 全プラットフォーム | Apify MCP | P2 |
| FR-1.1.6 | フォロワー/フォロイーリスト | X/Instagram/TikTok | Apify MCP | P2 |
| FR-1.1.7 | 動画字幕・トランスクリプト | YouTube/TikTok | Apify + YouTube Transcript MCP | P1 |
| FR-1.1.8 | 広告データ（Meta広告ライブラリ） | Facebook/Instagram | Apify MCP | P3 |
| FR-1.1.9 | トレンドトピック | 全プラットフォーム | What's Trending MCP | P1 |

**受入基準**:
- [ ] 各プラットフォームからJSON形式で構造化データが取得できること
- [ ] 1回のデータ収集で1プラットフォームあたり最低100件の投稿データが取得可能であること
- [ ] データ取得失敗時にエラーログが記録され、リトライが自動実行されること

### FR-1.2 データ収集スケジューリング

> **要件**: データ収集をスケジュール実行でき、収集頻度をプラットフォームごとに設定できること。

| ID | 要件詳細 | 優先度 |
|----|----------|--------|
| FR-1.2.1 | 日次自動収集（デフォルト: 毎日AM6:00 JST） | P1 |
| FR-1.2.2 | プラットフォーム別の収集間隔設定（1時間〜24時間） | P2 |
| FR-1.2.3 | 手動トリガーによるオンデマンド収集 | P1 |
| FR-1.2.4 | トレンドトピック即時検出（リアルタイム監視モード） | P2 |

**受入基準**:
- [ ] Cron式またはGUIでスケジュール設定が可能であること
- [ ] スケジュール実行が±5分以内の精度で動作すること

### FR-1.3 データ正規化・構造化

> **要件**: 収集した生データをプラットフォーム間で比較可能な統一フォーマットに正規化すること。

| ID | 要件詳細 | 優先度 |
|----|----------|--------|
| FR-1.3.1 | 統一データスキーマ（UnifiedPost型）への変換 | P1 |
| FR-1.3.2 | タイムスタンプのJST統一 | P1 |
| FR-1.3.3 | エンゲージメント率の統一計算式適用 | P1 |
| FR-1.3.4 | メディアURL・サムネイルの保存 | P2 |
| FR-1.3.5 | 重複検出・排除 | P1 |

**統一データスキーマ（UnifiedPost）**:
```typescript
interface UnifiedPost {
  id: string;                      // 内部管理ID
  platform: Platform;              // SNSプラットフォーム種別
  platformPostId: string;          // プラットフォーム固有ID
  author: {
    username: string;
    displayName: string;
    followers: number;
    verified: boolean;
    profileUrl: string;
  };
  content: {
    text: string;
    media: MediaItem[];            // 画像/動画URL
    hashtags: string[];
    mentions: string[];
    urls: string[];
    language: string;              // ISO 639-1
  };
  engagement: {
    likes: number;
    shares: number;                // RT/リポスト/シェア
    comments: number;
    views: number;
    engagementRate: number;        // 統一計算式
    saves: number;                 // 保存/ブックマーク
  };
  metadata: {
    publishedAt: string;           // ISO 8601 JST
    collectedAt: string;           // ISO 8601 JST
    postType: PostType;            // text/image/video/reel/story/thread
    permalink: string;
  };
  analysis?: {
    sentiment: SentimentResult;
    topics: string[];
    trendScore: number;            // 0-100
  };
}

type Platform = 'twitter' | 'instagram' | 'youtube' | 'tiktok' | 'facebook'
              | 'linkedin' | 'reddit' | 'pinterest' | 'threads' | 'bluesky';

type PostType = 'text' | 'image' | 'video' | 'reel' | 'story' | 'thread'
              | 'short' | 'pin' | 'article' | 'poll';
```

**受入基準**:
- [ ] 全10プラットフォームのデータがUnifiedPost型に正規化されること
- [ ] エンゲージメント率がプラットフォーム間で比較可能な統一式で計算されること
- [ ] 重複投稿が95%以上の精度で検出・除外されること

### FR-1.4 Apify MCPサーバー統合

> **要件**: Apify MCPサーバーを介して、以下のActorが呼び出し可能であること。

| ID | Actor | 用途 | 優先度 |
|----|-------|------|--------|
| FR-1.4.1 | apify/instagram-scraper | Instagram総合スクレイピング | P1 |
| FR-1.4.2 | apidojo/tweet-scraper | Twitter/Xツイート取得 | P1 |
| FR-1.4.3 | streamers/youtube-scraper | YouTubeチャンネル・動画取得 | P1 |
| FR-1.4.4 | clockworks/tiktok-scraper | TikTok動画・プロフィール取得 | P1 |
| FR-1.4.5 | apify/facebook-posts-scraper | Facebook投稿取得 | P2 |
| FR-1.4.6 | dev_fusion/linkedin-profile-scraper | LinkedInプロフィール取得 | P2 |
| FR-1.4.7 | trudax/reddit-scraper | Reddit投稿・コメント取得 | P2 |
| FR-1.4.8 | easyapi/pinterest-search-scraper | Pinterestピン検索 | P3 |
| FR-1.4.9 | red.cars/threads-scraper | Threadsデータ取得 | P3 |
| FR-1.4.10 | red.cars/bluesky-scraper | Blueskyデータ取得 | P3 |

**受入基準**:
- [ ] `mcp.apify.com` エンドポイント経由で各Actorが呼び出し可能であること
- [ ] Actor実行結果がJSON形式でDatasetに保存されること
- [ ] エラー発生時にリトライ（最大3回）が実行されること

### FR-1.5 SociaVault MCP統合

> **要件**: SociaVault MCPを介して7プラットフォームの統合データアクセスが可能であること。

| ID | 機能 | 優先度 |
|----|------|--------|
| FR-1.5.1 | 自然言語クエリによるSNSデータ検索 | P1 |
| FR-1.5.2 | 複数プラットフォーム横断検索 | P1 |
| FR-1.5.3 | プロフィール・投稿・エンゲージメントの統合取得 | P1 |

**受入基準**:
- [ ] SociaVault APIが正常にMCP経由で応答すること
- [ ] 7プラットフォーム（Instagram/TikTok/X/Threads/YouTube/Facebook/Reddit）からデータ取得可能であること

### FR-1.6 トレンド監視

> **要件**: What's Trending MCPを通じて、35以上のソースからリアルタイムのトレンドトピックを収集できること。

| ID | 機能 | 優先度 |
|----|------|--------|
| FR-1.6.1 | マルチソーストレンド収集（35+ソース） | P1 |
| FR-1.6.2 | トレンドのカテゴリ分類・フィルタリング | P2 |
| FR-1.6.3 | トレンドスコアリング（バイラリティ指標） | P2 |
| FR-1.6.4 | 急上昇トレンドのアラート通知 | P2 |

**受入基準**:
- [ ] 日次でトレンドデータが自動取得されること
- [ ] トレンドが業界/カテゴリでフィルタリング可能であること

---

## 6. 機能要件 — Layer 2: 分析層

### FR-2.1 SNSパフォーマンス分析

> **要件**: Social Media Analyzer Skillを使用して、収集データからSNSパフォーマンスを多角的に分析できること。

| ID | 分析機能 | 詳細 | 優先度 |
|----|----------|------|--------|
| FR-2.1.1 | エンゲージメント分析 | エンゲージメント率、リーチ、インプレッション、CTR計算 | P1 |
| FR-2.1.2 | 投稿パフォーマンスランキング | プラットフォーム別TOP投稿の自動抽出 | P1 |
| FR-2.1.3 | 最適投稿時間帯分析 | 曜日×時間帯のエンゲージメントヒートマップ | P2 |
| FR-2.1.4 | コンテンツタイプ別分析 | テキスト/画像/動画/リールのパフォーマンス比較 | P1 |
| FR-2.1.5 | フォロワー成長分析 | 期間別フォロワー増減トレンド | P2 |
| FR-2.1.6 | ROI分析 | コスト/エンゲージメント、ROAS計算 | P3 |

**受入基準**:
- [ ] 5プラットフォーム（X/Instagram/YouTube/TikTok/Facebook）の分析が実行可能であること
- [ ] 分析結果がJSON+Markdown形式でレポート出力されること
- [ ] 期間指定（日/週/月/カスタム）による分析が可能であること

### FR-2.2 センチメント分析

> **要件**: 収集した投稿・コメントに対してセンチメント分析を実行し、感情傾向を数値化できること。

| ID | 機能 | 詳細 | 優先度 |
|----|------|------|--------|
| FR-2.2.1 | 3段階分類 | Positive / Neutral / Negative | P1 |
| FR-2.2.2 | 6感情検出 | 怒り/嫌悪/恐怖/喜び/悲しみ/驚き | P2 |
| FR-2.2.3 | 日本語対応 | 日本語テキストのセンチメント分析精度80%以上 | P1 |
| FR-2.2.4 | 時系列トレンド | センチメントの時系列変化追跡 | P2 |
| FR-2.2.5 | キーワード別感情分析 | 特定キーワード/ブランド名に対するセンチメント | P2 |

**受入基準**:
- [ ] 英語テキストのセンチメント分類精度が85%以上であること
- [ ] 日本語テキストのセンチメント分類精度が80%以上であること
- [ ] 分析結果にスコア（-1.0〜+1.0）が付与されること

### FR-2.3 トレンド検出・分析

> **要件**: 収集データからトレンドを自動検出し、コンテンツ提案につなげること。

| ID | 機能 | 詳細 | 優先度 |
|----|------|------|--------|
| FR-2.3.1 | バズ投稿検出 | 通常の3倍以上のエンゲージメントを持つ投稿の自動検出 | P1 |
| FR-2.3.2 | トレンドハッシュタグ抽出 | 急上昇ハッシュタグの自動検出・ランキング | P1 |
| FR-2.3.3 | トピッククラスタリング | 類似トピックのグループ化 | P2 |
| FR-2.3.4 | トレンド予測 | 過去データから今後のトレンドを予測 | P3 |
| FR-2.3.5 | コンテンツギャップ分析 | 競合が扱っていないトピックの発見 | P2 |

**受入基準**:
- [ ] 過去7日間のバズ投稿TOP10が自動抽出されること
- [ ] 急上昇ハッシュタグが日次で更新されること
- [ ] トレンドスコア（0-100）が付与されること

### FR-2.4 競合分析

> **要件**: IMPACT Influencer Marketing Skillsを使用して、指定した競合アカウントの分析を自動実行できること。

| ID | 機能 | 詳細 | 優先度 |
|----|------|------|--------|
| FR-2.4.1 | 競合アカウント登録 | プラットフォーム別に最大20アカウント登録 | P1 |
| FR-2.4.2 | 投稿戦略比較 | 投稿頻度、投稿時間帯、コンテンツタイプ比較 | P1 |
| FR-2.4.3 | エンゲージメント比較 | 自社vs競合のエンゲージメント率比較 | P1 |
| FR-2.4.4 | コンテンツ差分分析 | 競合が扱うが自社が扱わないトピックの特定 | P2 |
| FR-2.4.5 | インフルエンサー発見 | 指定業界のインフルエンサー自動発見・フィットスコア | P2 |
| FR-2.4.6 | 競合レポート自動生成 | 週次/月次の競合分析レポート | P1 |

**受入基準**:
- [ ] 競合アカウントを登録し、自動的にデータ収集が開始されること
- [ ] 自社vs競合の比較チャートがMarkdown形式で出力されること
- [ ] 週次レポートが自動生成されること

### FR-2.5 SEO分析

> **要件**: DataForSEO MCP / SEO-GEO Skillsを使用して、以下のSEO分析が実行可能であること。

| ID | 機能 | 実装ツール | 優先度 |
|----|------|-----------|--------|
| FR-2.5.1 | キーワードリサーチ | DataForSEO MCP + SEO/GEO Skills | P1 |
| FR-2.5.2 | SERP分析 | DataForSEO MCP | P1 |
| FR-2.5.3 | 競合ドメイン分析 | DataForSEO MCP / Semrush MCP | P2 |
| FR-2.5.4 | バックリンク分析 | DataForSEO MCP | P2 |
| FR-2.5.5 | Google Search Console連携 | GSC MCP | P1 |
| FR-2.5.6 | GEO最適化分析 | SEO/GEO Skills（AI検索引用最適化） | P2 |
| FR-2.5.7 | テクニカルSEO監査 | SEO Specialist Skill | P2 |
| FR-2.5.8 | コンテンツギャップ分析 | SEO/GEO Skills | P1 |

**受入基準**:
- [ ] キーワードに対して検索ボリューム、競合度、CPC推定値が取得できること
- [ ] SERP上位10件の分析結果が出力されること
- [ ] 自社サイトのGSCデータが取得・分析可能であること

---

## 7. 機能要件 — Layer 3: コンテンツ生成層

### FR-3.1 コンテンツ企画

> **要件**: 分析結果を基に、記事テーマ・構成案を自動生成できること。

| ID | 機能 | 実装ツール | 優先度 |
|----|------|-----------|--------|
| FR-3.1.1 | トレンドベース記事テーマ提案 | Content Brief Generator Skill | P1 |
| FR-3.1.2 | キーワードベース記事構成生成 | SEO/GEO Skills | P1 |
| FR-3.1.3 | 競合コンテンツ差分からのテーマ発見 | Deep Research Skill | P2 |
| FR-3.1.4 | 記事ブリーフ自動生成 | Content Brief Generator Skill | P1 |
| FR-3.1.5 | SNSデータ引用の自動提案 | Social Media Analyzer Skill | P2 |

**受入基準**:
- [ ] トレンド分析結果から記事テーマが最低5候補提案されること
- [ ] 各テーマに対してH2/H3レベルの記事構成案が生成されること
- [ ] ブリーフにターゲットキーワード、想定文字数、参考URLが含まれること

### FR-3.2 記事自動生成

> **要件**: Content Research Writer Skillを中心に、SEO最適化されたブログ記事を自動生成できること。

| ID | 機能 | 詳細 | 優先度 |
|----|------|------|--------|
| FR-3.2.1 | リサーチ付き記事執筆 | Web情報+SNSデータを引用した記事生成 | P1 |
| FR-3.2.2 | SEO最適化 | メタタイトル、ディスクリプション、Schema自動生成 | P1 |
| FR-3.2.3 | 記事フォーマット | Markdown / HTML形式での出力 | P1 |
| FR-3.2.4 | 文字数制御 | 指定文字数（2,000〜10,000字）での生成 | P1 |
| FR-3.2.5 | フック（導入部）最適化 | 読者の興味を引く導入部の自動生成 | P1 |
| FR-3.2.6 | 引用・出典の自動挿入 | SNSデータ・Web情報の出典明記 | P1 |
| FR-3.2.7 | 画像挿入提案 | 記事内の適切な画像挿入位置と画像提案 | P2 |

**受入基準**:
- [ ] 3,000字以上の記事が自動生成可能であること
- [ ] SEOチェックリスト（タイトル60文字以内、ディスクリプション160文字以内、H2にキーワード含有）をパスすること
- [ ] 出典・引用が明記されていること
- [ ] 生成記事のSEOスコアが80点以上であること

### FR-3.3 ブランドボイス統一

> **要件**: Content Creator Skill（brand_voice_analyzer）を使用して、生成コンテンツのトーン・文体を統一できること。

| ID | 機能 | 詳細 | 優先度 |
|----|------|------|--------|
| FR-3.3.1 | ブランドボイスプロファイル設定 | トーン、語彙、禁止ワードの定義 | P1 |
| FR-3.3.2 | 既存コンテンツからのスタイル学習 | 過去記事からブランドボイスを自動抽出 | P2 |
| FR-3.3.3 | 生成コンテンツのスタイルチェック | ブランドボイス適合度スコアリング | P1 |
| FR-3.3.4 | 自動スタイル調整 | 不適合箇所の自動修正提案 | P2 |

**受入基準**:
- [ ] ブランドボイスプロファイルが設定ファイルとして保存可能であること
- [ ] 生成記事がブランドボイス適合度70%以上であること

### FR-3.4 コンテンツリパーパス

> **要件**: 1つのコンテンツ（記事）を複数フォーマットに自動変換できること。

| ID | 変換先 | 実装ツール | 優先度 |
|----|--------|-----------|--------|
| FR-3.4.1 | ブログ記事 → SNS投稿テキスト（X/LinkedIn/Facebook） | Content Atomizer Skill + Social Media Post Generator Skill | P1 |
| FR-3.4.2 | ブログ記事 → Instagramキャプション | Social Content Skill | P1 |
| FR-3.4.3 | ブログ記事 → ショート動画台本 | Content Atomizer Skill | P1 |
| FR-3.4.4 | ブログ記事 → メールニュースレター | Content Atomizer Skill | P2 |
| FR-3.4.5 | ブログ記事 → スレッド投稿 | Social Media Post Generator Skill | P2 |
| FR-3.4.6 | 記事要約 → Pinterest用テキスト | カスタム生成 | P3 |

**受入基準**:
- [ ] 1記事から最低3種類のSNS投稿テキストが自動生成されること
- [ ] 各SNSの文字数制限（X:280字、LinkedIn:3,000字等）を遵守すること
- [ ] ショート動画台本が30秒〜60秒の尺で生成されること

### FR-3.5 ショート動画コンテンツ

> **要件**: Short Video Maker MCPを使用して、テキストベースのショート動画を自動生成できること。

| ID | 機能 | 詳細 | 優先度 |
|----|------|------|--------|
| FR-3.5.1 | テキスト→動画変換 | 台本テキストからTikTok/Reels/Shorts用動画生成 | P2 |
| FR-3.5.2 | TTS（テキスト読み上げ） | 日本語/英語対応の音声合成 | P2 |
| FR-3.5.3 | 自動キャプション | 字幕の自動生成・合成 | P2 |
| FR-3.5.4 | BGM統合 | 著作権フリーBGMの自動選択・合成 | P3 |

**受入基準**:
- [ ] 30秒〜60秒のショート動画が自動生成されること
- [ ] 縦型（9:16）フォーマットで出力されること
- [ ] 日本語TTSが正確に読み上げ可能であること

---

## 8. 機能要件 — Layer 4: 配信層

### FR-4.1 CMS自動公開

> **要件**: 生成した記事をGhost CMS / WordPressに自動公開できること。

| ID | 機能 | 実装ツール | 優先度 |
|----|------|-----------|--------|
| FR-4.1.1 | Ghost CMSへの記事投稿 | Ghost CMS MCP | P1 |
| FR-4.1.2 | WordPressへの記事投稿 | WordPress MCP | P1 |
| FR-4.1.3 | 下書き/公開/予約公開の制御 | CMS MCP | P1 |
| FR-4.1.4 | カテゴリ・タグの自動設定 | CMS MCP | P1 |
| FR-4.1.5 | アイキャッチ画像の設定 | CMS MCP | P2 |
| FR-4.1.6 | Notionへの記事管理連携 | Notion MCP | P2 |

**受入基準**:
- [ ] 生成記事がGhostまたはWordPressに下書きとして保存されること
- [ ] 公開承認ワークフロー（下書き→レビュー→公開）が機能すること
- [ ] メタ情報（タイトル/ディスクリプション/OGP）が自動設定されること

### FR-4.2 SNS自動投稿

> **要件**: 各SNSプラットフォームへのコンテンツ自動投稿が可能であること。

| ID | プラットフォーム | 実装ツール | 投稿タイプ | 優先度 |
|----|-----------------|-----------|-----------|--------|
| FR-4.2.1 | Twitter/X | X API MCP | テキスト+画像+リンク | P1 |
| FR-4.2.2 | Instagram | Ig MCP | 画像+キャプション | P1 |
| FR-4.2.3 | LinkedIn | LinkedIn Post Creator MCP | テキスト+画像+リンク | P1 |
| FR-4.2.4 | Facebook | Facebook MCP | テキスト+画像+リンク | P2 |
| FR-4.2.5 | Reddit | Reddit MCP | テキスト+リンク | P3 |

**受入基準**:
- [ ] 各プラットフォームの投稿APIが正常に動作すること
- [ ] 投稿スケジュール（予約投稿）が設定可能であること
- [ ] 投稿失敗時にリトライとアラート通知が発生すること

### FR-4.3 配信レポート

> **要件**: 配信したコンテンツのパフォーマンスを追跡し、レポートを生成できること。

| ID | 機能 | 詳細 | 優先度 |
|----|------|------|--------|
| FR-4.3.1 | 投稿パフォーマンス追跡 | 配信後24h/48h/7dのエンゲージメント計測 | P1 |
| FR-4.3.2 | A/Bテスト結果比較 | 異なるコンテンツバリエーションの比較 | P3 |
| FR-4.3.3 | 配信レポート自動生成 | 週次/月次の配信パフォーマンスレポート | P1 |

**受入基準**:
- [ ] 投稿後7日間のエンゲージメントデータが自動取得されること
- [ ] 配信レポートがMarkdown形式で自動生成されること

---

## 9. 機能要件 — Layer 5: 自動化オーケストレーション層

### FR-5.1 ワークフロー定義

> **要件**: n8n MCPを使用して、以下のワークフローを定義・実行できること。

| ID | ワークフロー名 | パイプライン | 優先度 |
|----|----------------|-------------|--------|
| FR-5.1.1 | `sns-full-analysis` | 全SNSデータ収集 → 正規化 → 分析 → レポート生成 | P1 |
| FR-5.1.2 | `sns-to-article` | トレンド分析 → 記事企画 → 執筆 → SEO最適化 → CMS公開 | P1 |
| FR-5.1.3 | `trend-monitoring` | 35+ソース監視 → アラート → コンテンツ提案 | P2 |
| FR-5.1.4 | `competitor-analysis` | 競合データ収集 → 比較分析 → 差分レポート | P2 |
| FR-5.1.5 | `content-repurpose` | 記事取得 → SNS投稿生成×N → ショート動画台本生成 | P1 |
| FR-5.1.6 | `performance-feedback` | 配信後データ収集 → パフォーマンス分析 → 改善提案 | P2 |

**受入基準**:
- [ ] 各ワークフローがn8n MCP経由で定義・実行可能であること
- [ ] ワークフロー実行ログが記録されること
- [ ] エラー発生時にリトライとアラートが機能すること

### FR-5.2 スケジュール管理

| ID | 機能 | デフォルト値 | 優先度 |
|----|------|-------------|--------|
| FR-5.2.1 | 日次データ収集 | AM 6:00 JST | P1 |
| FR-5.2.2 | 日次トレンド分析 | AM 7:00 JST | P1 |
| FR-5.2.3 | 週次分析レポート | 月曜 AM 9:00 JST | P1 |
| FR-5.2.4 | 週次記事生成（推奨トピック） | 火曜 AM 10:00 JST | P2 |
| FR-5.2.5 | 月次総合レポート | 毎月1日 AM 9:00 JST | P2 |

### FR-5.3 taisun_agent統合

> **要件**: 既存のtaisun_agent v2.6.0のアーキテクチャに統合し、既存の13層防御システムと共存すること。

| ID | 統合項目 | 詳細 | 優先度 |
|----|----------|------|--------|
| FR-5.3.1 | MCP設定追加 | `.mcp.json` へのSNS系MCPサーバー追加 | P1 |
| FR-5.3.2 | スキル配置 | `.claude/skills/` への新規スキルディレクトリ追加 | P1 |
| FR-5.3.3 | ワークフロー登録 | `proxy-mcp/workflow/` への新ワークフロー追加 | P1 |
| FR-5.3.4 | エージェント追加 | SNS分析専用エージェントの定義 | P2 |
| FR-5.3.5 | コマンド追加 | SNS分析系スラッシュコマンドの追加 | P2 |
| FR-5.3.6 | 防御層との共存 | 13層防御のSkill Evidence / Permission Gate通過 | P1 |

**受入基準**:
- [ ] `npm run taisun:diagnose` で100/100点を維持すること
- [ ] 既存の13層防御システムが正常動作を維持すること
- [ ] 新規追加MCP/Skill/Workflowがtaisun_agentの管理下に置かれること

---

## 10. 非機能要件

### NFR-1 パフォーマンス

| ID | 要件 | 目標値 |
|----|------|--------|
| NFR-1.1 | 単一プラットフォームのデータ収集完了時間 | 5分以内 |
| NFR-1.2 | 全10プラットフォームの一括収集完了時間 | 30分以内 |
| NFR-1.3 | 1記事の自動生成完了時間 | 10分以内 |
| NFR-1.4 | SNS投稿の自動配信完了時間 | 1分以内/プラットフォーム |
| NFR-1.5 | 分析レポート生成時間 | 5分以内 |

### NFR-2 可用性

| ID | 要件 | 目標値 |
|----|------|--------|
| NFR-2.1 | スケジュール実行の信頼性 | 99%以上 |
| NFR-2.2 | データ収集成功率 | 95%以上（プラットフォーム変更による一時的な低下を除く） |
| NFR-2.3 | APIレート制限への自動対応 | レート制限検出時に自動待機・リトライ |

### NFR-3 拡張性

| ID | 要件 | 詳細 |
|----|------|------|
| NFR-3.1 | 新規SNSプラットフォーム追加 | MCP/Actor追加のみで対応可能な設計 |
| NFR-3.2 | 新規分析機能追加 | Skillファイル追加のみで対応可能な設計 |
| NFR-3.3 | 新規CMS対応 | MCP追加のみで対応可能な設計 |

### NFR-4 運用性

| ID | 要件 | 詳細 |
|----|------|------|
| NFR-4.1 | ログ管理 | 全ワークフロー実行ログの保存（30日間） |
| NFR-4.2 | エラー通知 | 重大エラー発生時のSlack/メール通知 |
| NFR-4.3 | ダッシュボード | 実行状況・成功率・コスト一覧の可視化 |

### NFR-5 コスト

| ID | 要件 | 目標値 |
|----|------|--------|
| NFR-5.1 | 月間運用コスト（推奨構成） | $200以内（API使用量除く） |
| NFR-5.2 | 無料枠の最大活用 | YouTube API / GSC / OSS Skills / Crawl4AI等の無料ツール優先利用 |
| NFR-5.3 | コスト可視化 | Apify / 外部API使用量の月次サマリー |

---

## 11. 外部インターフェース要件

### EIF-1 MCP接続設定

```json
{
  "mcpServers": {
    "apify": {
      "url": "https://mcp.apify.com",
      "headers": { "Authorization": "Bearer ${APIFY_TOKEN}" }
    },
    "sociavault": {
      "url": "https://api.sociavault.com/mcp",
      "headers": { "Authorization": "Bearer ${SOCIAVAULT_TOKEN}" }
    },
    "dataforseo": {
      "command": "npx",
      "args": ["dataforseo-mcp-server"],
      "env": {
        "DATAFORSEO_LOGIN": "${DATAFORSEO_LOGIN}",
        "DATAFORSEO_PASSWORD": "${DATAFORSEO_PASSWORD}"
      }
    },
    "google-search-console": {
      "command": "npx",
      "args": ["gsc-mcp-server"],
      "env": { "GSC_CREDENTIALS": "${GSC_CREDENTIALS}" }
    },
    "whats-trending": {
      "command": "npx",
      "args": ["whats-trending-mcp-server"]
    },
    "n8n": {
      "command": "npx",
      "args": ["n8n-mcp-server"]
    },
    "ghost-cms": {
      "command": "npx",
      "args": ["ghost-mcp-server"],
      "env": {
        "GHOST_URL": "${GHOST_URL}",
        "GHOST_ADMIN_KEY": "${GHOST_ADMIN_KEY}"
      }
    },
    "x-api": {
      "command": "npx",
      "args": ["x-api-mcp-server"],
      "env": {
        "X_API_KEY": "${X_API_KEY}",
        "X_API_SECRET": "${X_API_SECRET}"
      }
    },
    "instagram": {
      "command": "npx",
      "args": ["ig-mcp-server"],
      "env": { "IG_ACCESS_TOKEN": "${IG_ACCESS_TOKEN}" }
    },
    "linkedin": {
      "command": "npx",
      "args": ["linkedin-mcp-server"],
      "env": { "LINKEDIN_TOKEN": "${LINKEDIN_TOKEN}" }
    },
    "short-video-maker": {
      "command": "npx",
      "args": ["short-video-maker-mcp"]
    }
  }
}
```

### EIF-2 環境変数

| 変数名 | 用途 | 必須 |
|--------|------|------|
| APIFY_TOKEN | Apify APIトークン | P1 |
| SOCIAVAULT_TOKEN | SociaVault APIトークン | P1 |
| DATAFORSEO_LOGIN | DataForSEOログインID | P2 |
| DATAFORSEO_PASSWORD | DataForSEOパスワード | P2 |
| GSC_CREDENTIALS | Google Search Console認証情報 | P1 |
| GHOST_URL | Ghost CMSのURL | P1 |
| GHOST_ADMIN_KEY | Ghost CMS管理キー | P1 |
| X_API_KEY | Twitter/X APIキー | P1 |
| X_API_SECRET | Twitter/X APIシークレット | P1 |
| IG_ACCESS_TOKEN | Instagram Graph APIトークン | P1 |
| LINKEDIN_TOKEN | LinkedIn APIトークン | P2 |

---

## 12. データ要件

### DR-1 データ保存

| ID | データ種別 | 保存先 | 保持期間 |
|----|-----------|--------|----------|
| DR-1.1 | 収集生データ（UnifiedPost） | Apify Dataset / ローカルJSON | 90日 |
| DR-1.2 | 分析結果レポート | `docs/reports/` | 永続 |
| DR-1.3 | 生成記事（下書き+公開済み） | CMS + ローカルMarkdown | 永続 |
| DR-1.4 | ワークフロー実行ログ | `logs/` | 30日 |
| DR-1.5 | 競合分析データ | ローカルJSON | 180日 |
| DR-1.6 | トレンドデータ履歴 | ローカルJSON | 365日 |

### DR-2 データ量見積もり

| データ種別 | 日次量（概算） | 月次量（概算） |
|-----------|---------------|---------------|
| 投稿データ（10プラットフォーム） | 1,000〜5,000件 | 30,000〜150,000件 |
| トレンドデータ | 100〜500件 | 3,000〜15,000件 |
| 分析レポート | 1〜3件 | 30〜90件 |
| 生成記事 | 1〜3件 | 30〜90件 |
| SNS投稿テキスト | 5〜15件 | 150〜450件 |

---

## 13. セキュリティ要件

| ID | 要件 | 詳細 | 優先度 |
|----|------|------|--------|
| SEC-01 | APIキー管理 | 全APIキーは`.env`に格納、`.gitignore`で除外 | P1 |
| SEC-02 | OAuth 2.0対応 | SNS APIはOAuth 2.0認証を使用 | P1 |
| SEC-03 | データスクレイピング準拠 | 公開データのみ取得、robots.txt遵守、GDPR/個人情報保護法準拠 | P1 |
| SEC-04 | レート制限遵守 | 各SNS APIのレート制限を遵守するスロットリング実装 | P1 |
| SEC-05 | ログのサニタイズ | ログ出力にAPIキー・トークンを含めない | P1 |
| SEC-06 | 最小権限原則 | 各APIは必要最小限のスコープのみ要求 | P1 |
| SEC-07 | 個人情報の取り扱い | スクレイピングしたユーザー情報の保存制限（分析用集計のみ） | P1 |
| SEC-08 | taisun防御層との統合 | Input Sanitizer / Copy Safety Guardとの連携 | P1 |

---

## 14. 制約事項と前提条件

### 14.1 制約事項

| ID | 制約 | 影響 |
|----|------|------|
| C-01 | Twitter/X公式APIの高額料金（Basic $100/月〜） | Apify/BrightData経由のスクレイピングを主要手段とする |
| C-02 | Instagram Graph APIのレート制限（200コール/時） | バッチ処理とキャッシュ戦略が必要 |
| C-03 | LinkedInスクレイピングの制限（500プロフィール/日） | 収集対象の優先順位付けが必要 |
| C-04 | Pinterest API昇格にはデモ動画提出が必要 | Phase 3以降で対応 |
| C-05 | 各SNSプラットフォームのTOS変更リスク | スクレイピング戦略の定期的な見直しが必要 |
| C-06 | Apify Free Planの制限（$5/月クレジット） | テスト段階のみ。本格運用はStarter以上 |

### 14.2 前提条件

| ID | 前提 |
|----|------|
| P-01 | taisun_agent v2.6.0が正常に動作していること |
| P-02 | Node.js v18以上がインストールされていること |
| P-03 | Apifyアカウントが作成済みであること |
| P-04 | 対象SNSプラットフォームのビジネスアカウントが取得済みであること |
| P-05 | Ghost CMS / WordPressの管理者権限があること |
| P-06 | Google Search Consoleの対象サイトが登録済みであること |

---

## 15. 受入基準

### Phase 1 受入基準（基盤構築）

| ID | 基準 | 検証方法 |
|----|------|----------|
| AC-P1-01 | Apify MCPサーバーが接続され、Actorが呼び出し可能 | `call-actor`ツールでInstagram Scraperを実行しJSON取得確認 |
| AC-P1-02 | SociaVault MCPが接続され、データ取得可能 | 任意のユーザー名でプロフィールデータ取得確認 |
| AC-P1-03 | GSC MCPが接続され、検索パフォーマンスデータ取得可能 | 直近7日間のクエリデータ取得確認 |
| AC-P1-04 | Social Media Analyzer Skillがインストール済み | スキル呼び出しでサンプル分析が実行可能 |
| AC-P1-05 | SEO/GEO Skills（16個）がインストール済み | キーワードリサーチスキルの実行確認 |
| AC-P1-06 | `taisun:diagnose` が100/100点 | 全13層防御＋新規コンポーネントが正常 |

### Phase 2 受入基準（データ収集パイプライン）

| ID | 基準 | 検証方法 |
|----|------|----------|
| AC-P2-01 | P1プラットフォーム（X/Instagram/YouTube/TikTok）からデータ取得可能 | 各プラットフォームで100件以上の投稿データ取得確認 |
| AC-P2-02 | 取得データがUnifiedPost形式に正規化される | スキーマバリデーション通過確認 |
| AC-P2-03 | トレンドデータが35+ソースから取得可能 | What's Trending MCPの実行確認 |
| AC-P2-04 | スケジュール実行が動作する | 日次自動収集の24h動作確認 |

### Phase 3 受入基準（分析エンジン）

| ID | 基準 | 検証方法 |
|----|------|----------|
| AC-P3-01 | センチメント分析が日本語で動作する | 日本語テキスト100件の分析精度80%以上 |
| AC-P3-02 | 競合分析レポートが自動生成される | 3競合アカウント登録後、比較レポート生成確認 |
| AC-P3-03 | SEO分析が実行可能 | 指定キーワードの検索ボリューム・SERP分析確認 |
| AC-P3-04 | トレンド検出が機能する | 過去7日間のバズ投稿TOP10が抽出確認 |

### Phase 4 受入基準（コンテンツ生成パイプライン）

| ID | 基準 | 検証方法 |
|----|------|----------|
| AC-P4-01 | SNSデータを基にした記事が自動生成される | トレンドデータ→3,000字以上の記事生成確認 |
| AC-P4-02 | SEOスコア80点以上の記事が生成される | SEOチェックリスト全項目パス確認 |
| AC-P4-03 | 記事がCMSに下書き保存される | Ghost/WordPressへの自動投稿確認 |
| AC-P4-04 | ブランドボイスが統一されている | ブランドボイス適合度70%以上の確認 |

### Phase 5 受入基準（マルチチャネル配信）

| ID | 基準 | 検証方法 |
|----|------|----------|
| AC-P5-01 | 記事からSNS投稿テキストが自動生成される | 1記事→3種類以上のSNS投稿生成確認 |
| AC-P5-02 | SNS自動投稿が機能する | X/LinkedIn/Facebookへのテスト投稿確認 |
| AC-P5-03 | ショート動画台本が生成される | 30秒台本の自動生成確認 |
| AC-P5-04 | 配信パフォーマンスレポートが生成される | 投稿後7日間のエンゲージメントレポート確認 |
| AC-P5-05 | E2Eワークフローが動作する | `sns-to-article`ワークフロー全工程の通し実行確認 |

---

## 16. 実装フェーズ定義

### Phase 1: 基盤構築

**目標**: MCPサーバー接続とスキルインストールの完了

| タスク | 詳細 | 依存 |
|--------|------|------|
| 1-1. MCP設定ファイル作成 | `.mcp.json`への新規MCPサーバー追加 | なし |
| 1-2. 環境変数設定 | `.env`へのAPIキー・トークン設定 | Apify/SociaVault等のアカウント作成 |
| 1-3. Apify MCP接続確認 | Actor呼び出しテスト | 1-1, 1-2 |
| 1-4. SociaVault MCP接続確認 | データ取得テスト | 1-1, 1-2 |
| 1-5. GSC MCP接続確認 | 検索データ取得テスト | 1-1, 1-2 |
| 1-6. スキルインストール | SNS分析/SEO/コンテンツ系スキルの配置 | なし |
| 1-7. n8n MCP接続確認 | ワークフロー基盤テスト | 1-1 |
| 1-8. taisun:diagnose確認 | 100/100点の維持確認 | 1-1〜1-7 |

### Phase 2: データ収集パイプライン

**目標**: 全10プラットフォームからのデータ自動収集と正規化

| タスク | 詳細 | 依存 |
|--------|------|------|
| 2-1. UnifiedPostスキーマ定義 | TypeScript型定義ファイル作成 | なし |
| 2-2. P1プラットフォーム収集実装 | X/Instagram/YouTube/TikTokのActor設定 | Phase 1 |
| 2-3. P2プラットフォーム収集実装 | Facebook/LinkedIn/Redditの設定 | Phase 1 |
| 2-4. P3プラットフォーム収集実装 | Pinterest/Threads/Blueskyの設定 | Phase 1 |
| 2-5. データ正規化パイプライン | 生データ→UnifiedPost変換ロジック | 2-1 |
| 2-6. 重複検出・排除ロジック | プラットフォームID+URLベースの重複検出 | 2-5 |
| 2-7. トレンド監視設定 | What's Trending MCP設定 | Phase 1 |
| 2-8. スケジュール設定 | n8n/Apify Schedulerでの日次自動収集 | 2-2〜2-7 |

### Phase 3: 分析エンジン

**目標**: 多角的な分析機能の実装

| タスク | 詳細 | 依存 |
|--------|------|------|
| 3-1. SNSパフォーマンス分析 | Social Media Analyzer Skillの統合 | Phase 2 |
| 3-2. センチメント分析 | 日本語対応センチメント分析実装 | Phase 2 |
| 3-3. トレンド検出 | バズ投稿検出・ハッシュタグランキング | Phase 2 |
| 3-4. 競合分析 | IMPACT Skills統合・競合ダッシュボード | Phase 2 |
| 3-5. SEO分析パイプライン | DataForSEO + GSC連携 | Phase 1 |
| 3-6. 分析レポート自動生成 | 週次/月次レポートテンプレート | 3-1〜3-5 |

### Phase 4: コンテンツ生成パイプライン

**目標**: 分析→記事生成→CMS公開の自動化

| タスク | 詳細 | 依存 |
|--------|------|------|
| 4-1. 記事企画自動生成 | Content Brief Generator統合 | Phase 3 |
| 4-2. 記事自動執筆 | Content Research Writer統合 | 4-1 |
| 4-3. SEO最適化自動適用 | SEO Specialist Skill統合 | 4-2 |
| 4-4. ブランドボイスチェック | Content Creator Skill統合 | 4-2 |
| 4-5. CMS自動公開 | Ghost/WordPress MCP連携 | 4-3, 4-4 |
| 4-6. コンテンツリパーパス | Content Atomizer統合 | 4-2 |

### Phase 5: マルチチャネル配信

**目標**: SNS自動投稿・動画生成・フィードバックループの完成

| タスク | 詳細 | 依存 |
|--------|------|------|
| 5-1. SNS投稿テキスト自動生成 | Social Media Post Generator統合 | Phase 4 |
| 5-2. SNS自動投稿 | X/Ig/LinkedIn/Facebook MCP連携 | 5-1 |
| 5-3. ショート動画生成 | Short Video Maker MCP統合 | Phase 4 |
| 5-4. 配信パフォーマンス追跡 | 投稿後エンゲージメント自動取得 | 5-2 |
| 5-5. フィードバックループ | パフォーマンス→次回コンテンツへの反映 | 5-4 |
| 5-6. E2Eワークフロー統合テスト | `sns-to-article`全工程通し実行 | 5-1〜5-5 |

---

## 17. 用語集

| 用語 | 説明 |
|------|------|
| **MCP** | Model Context Protocol。AIモデルと外部ツールを接続する標準プロトコル |
| **Actor** | Apifyプラットフォーム上のコンテナ化されたスクレイピングプログラム |
| **Skill** | Claude Code用の再利用可能な専門知識・ワークフロー定義（SKILL.mdファイル） |
| **CU** | Compute Unit。Apifyの計算リソース単位（1CU ≒ 1GHz-hour CPU + 1GB-hour RAM） |
| **GEO** | Generative Engine Optimization。AI検索（ChatGPT/Claude/Perplexity等）に引用されるための最適化 |
| **SERP** | Search Engine Results Page。検索エンジン結果ページ |
| **UnifiedPost** | 本システムの統一データスキーマ。全SNSプラットフォームのデータを共通形式で格納 |
| **taisun_agent** | 既存のAIエージェント統合システム（v2.6.0）。本システムの基盤 |
| **n8n** | オープンソースのワークフロー自動化ツール |
| **SociaVault** | 7SNSプラットフォームの統合データアクセスMCPサーバー |

---

> **文書改訂履歴**
>
> | バージョン | 日付 | 変更内容 |
> |-----------|------|----------|
> | v1.0 | 2026-02-04 | 初版作成 |
